%% Load file (choose file name)
T = readtable('results_rrt_6.csv');

splineCount = max(T.spline_ind);
rrtCount = max(T.plan_ind);

figure;
colormap lines;
figBot = plot(T.x_1, T.x_2, '--'); 
hold on;
for p = 1:rrtCount
    for i = 0:splineCount
        selSpline = (T.spline_ind == i) & (T.plan_ind == p);
        plot(T.sigma_1(selSpline), T.sigma_2(selSpline));
    end
    
    transferPoints = (diff(T.plan_ind) ~= 0);
    figTransfer = scatter(T.x_1(transferPoints), T.x_2(transferPoints), '*');
end
xlabel('World X');
ylabel('World Y');
legend([figBot, figTransfer], 'Robot Path', 'RRT (planning) Events');
for i = 0:5
    x0 = 10 + 10 * i;
    y0 = 5;
    w = 5;
    h = 20;
    fill([x0, x0+w, x0+w, x0],[y0, y0, y0+h, y0+h], 'black');
end
fill([0, 80, 80, 0],[50, 50, 60, 60], 'black');
fill([90, 100, 100, 90],[50, 50, 60, 60], 'black');
title('Robot World'); hold off;

%%
figure;
colormap lines;
for p = 1:rrtCount
    for i = 0:splineCount
        selSpline = (T.spline_ind == i) & (T.plan_ind == p);
        plot(T.xi_1(selSpline), T.xi_1(selSpline)); hold on;
    end
end
xlabel('Xi_1');
ylabel('Xi_2');
title('Linearized State'); hold off;

%%
poly =  [  22.9799 -170.205  1477.34 -585.826 -342.783 -106.733; 
           1.69282 -8.02158  48.1345    239.5  115.987  35.1856 ];

plot(polyval(poly(1,end:-1:1), linspace(0,1.0 / 7.0)), polyval(poly(2,end:-1:1), linspace(0,1.0 / 7.0)))


%%
poly = [  22.9428  0.997451  -532.094   4842.01   1430.75   315.175;
  1.41113 0.0713487  -18.0264   395.049   167.713   47.6378];
      
plot(polyval(poly(1,end:-1:1), linspace(0,1.0 / 7.0, 1000)), polyval(poly(2,end:-1:1), linspace(0,1.0 / 7.0, 1000)))

%%
i = 1;
point = i / 4.0;
    polyA = [ 7.77399    1.69508   0.635654   0.211885  0.0662139    0;
     4.96254   -7.21912   -2.70717   -0.90239  -0.281997          0];
     polyB = [ 7.77399    2.40048   -2.81595   -3.41607   -2.61591          0;
     4.96254   -2.02678   -28.1137    -27.607   -20.0246          0];
plot(polyval(polyA(1,end:-1:1), point), polyval(polyA(2,end:-1:1), point), '*');
hold on;
plot(polyval(polyB(1,end:-1:1), point), polyval(polyB(2,end:-1:1), point), '+')

%%
Mat =  [ 1           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           1           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          1        0.25      0.0625    0.015625  0.00390625 0.000976562           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           1        0.25      0.0625    0.015625  0.00390625 0.000976562           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           1        0.25      0.0625    0.015625  0.00390625           0           0           0           0           0           0          -0          -1       -0.25     -0.0625   -0.015625 -0.00390625           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           1        0.25      0.0625    0.015625  0.00390625           0           0           0           0           0           0          -0          -1       -0.25     -0.0625   -0.015625 -0.00390625           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           1        0.25      0.0625    0.015625           0           0           0           0           0           0          -0          -0          -1       -0.25     -0.0625   -0.015625           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           1        0.25      0.0625    0.015625           0           0           0           0           0           0          -0          -0          -1       -0.25     -0.0625   -0.015625           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           1        0.25      0.0625    0.015625  0.00390625 0.000976562           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.25      0.0625    0.015625  0.00390625 0.000976562           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125      0.0625     0.03125           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125      0.0625     0.03125           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125      0.0625           0           0           0           0           0           0          -0          -1        -0.5       -0.25      -0.125     -0.0625           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125      0.0625           0           0           0           0           0           0          -0          -1        -0.5       -0.25      -0.125     -0.0625           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125           0           0           0           0           0           0          -0          -0          -1        -0.5       -0.25      -0.125           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125           0           0           0           0           0           0          -0          -0          -1        -0.5       -0.25      -0.125           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125      0.0625     0.03125           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125      0.0625     0.03125           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875    0.316406    0.237305           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875    0.316406    0.237305           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875    0.316406           0           0           0           0           0           0          -0          -1       -0.75     -0.5625   -0.421875   -0.316406           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875    0.316406           0           0           0           0           0           0          -0          -1       -0.75     -0.5625   -0.421875   -0.316406;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875           0           0           0           0           0           0          -0          -0          -1       -0.75     -0.5625   -0.421875           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875           0           0           0           0           0           0          -0          -0          -1       -0.75     -0.5625   -0.421875;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875    0.316406    0.237305           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875    0.316406    0.237305;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1           1           1           1           1           1           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1           1           1           1           1           1;
          1           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           1           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          1        0.25      0.0625    0.015625  0.00390625 0.000976562           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           1        0.25      0.0625    0.015625  0.00390625 0.000976562           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           1        0.25      0.0625    0.015625  0.00390625           0           0           0           0           0           0          -0          -1       -0.25     -0.0625   -0.015625 -0.00390625           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           1        0.25      0.0625    0.015625  0.00390625           0           0           0           0           0           0          -0          -1       -0.25     -0.0625   -0.015625 -0.00390625           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           1        0.25      0.0625    0.015625           0           0           0           0           0           0          -0          -0          -1       -0.25     -0.0625   -0.015625           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           1        0.25      0.0625    0.015625           0           0           0           0           0           0          -0          -0          -1       -0.25     -0.0625   -0.015625           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           1        0.25      0.0625    0.015625  0.00390625 0.000976562           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.25      0.0625    0.015625  0.00390625 0.000976562           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125      0.0625     0.03125           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125      0.0625     0.03125           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125      0.0625           0           0           0           0           0           0          -0          -1        -0.5       -0.25      -0.125     -0.0625           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125      0.0625           0           0           0           0           0           0          -0          -1        -0.5       -0.25      -0.125     -0.0625           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125           0           0           0           0           0           0          -0          -0          -1        -0.5       -0.25      -0.125           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125           0           0           0           0           0           0          -0          -0          -1        -0.5       -0.25      -0.125           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125      0.0625     0.03125           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1         0.5        0.25       0.125      0.0625     0.03125           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875    0.316406    0.237305           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875    0.316406    0.237305           0           0           0           0           0           0           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875    0.316406           0           0           0           0           0           0          -0          -1       -0.75     -0.5625   -0.421875   -0.316406           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875    0.316406           0           0           0           0           0           0          -0          -1       -0.75     -0.5625   -0.421875   -0.316406;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875           0           0           0           0           0           0          -0          -0          -1       -0.75     -0.5625   -0.421875           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875           0           0           0           0           0           0          -0          -0          -1       -0.75     -0.5625   -0.421875;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875    0.316406    0.237305           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1        0.75      0.5625    0.421875    0.316406    0.237305;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1           1           1           1           1           1           0           0           0           0           0           0;
          0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           0           1           1           1           1           1           1;
];
